<%
        COLOR_CHOICES = 6 %>
<style>
    .rotate90 {
        display: block;
        -webkit-transform:rotate(-90deg);
        -moz-transform:rotate(-90deg);
        -o-transform:rotate(-90deg);
        /* filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1.5); */
        -ms-transform:rotate(-90deg);
        white-space: nowrap;
    }

    .unbordered th {
        border-top-style: none;
        border-bottom-style: none;
    }

    <% _.range(0, COLOR_CHOICES).forEach(function(n){ %>
    .column<%= n %>, td  .column<%= n %>, th  .column<%= n %> {
        color: hsl(<%= Math.floor(360 * n/COLOR_CHOICES) %>, 30%, 50%);
        background-color: hsl(<%= Math.floor(360 * n/COLOR_CHOICES) %>, 33%, 90%);
        font-weight: 400 !important;
    }
    <% }) %>

</style>

<h1>Authentication</h1>

<div class="row-fluid">
    <div class="span9">
        <h2>Roles</h2>
        <table class="table table-condensed">
            <thead>
            <tr class="unbordered">
                <th>Role</th>

                <% member_actions.forEach(function(ma,i){
                if ((i % 3) == 0) {
                %>
                <th colspan="3" class="column<%= i % COLOR_CHOICES %>"><%= ma._id %></th>
                <%
                }
                }) %>
                <th>&nbsp;</th>
                <th>&nbsp;</th>
            </tr>
            <tr class="unbordered">
                <% if (false) _.range(0, 10).forEach(function(n){ %>
                <th><%= n %></th>
                <% }) %>
            </tr>
            <tr class="unbordered">
                <th>&nbsp;</th>
                <th>&nbsp;</th>

                <% member_actions.forEach(function(ma,i){
                if ((i % 3) == 1) {
                %>
                <th colspan="3" class="column<%= i % COLOR_CHOICES %>"><%= ma._id %></th>
                <%
                }
                }) %>
                <th>&nbsp;</th>
            </tr>
            <tr  class="unbordered">
                <th>&nbsp;</th>
                <th>&nbsp;</th>
                <th>&nbsp;</th>

                <% member_actions.forEach(function(ma,i){
                if ((i % 3) == 2) {
                %>
                <th colspan="3" class="column<%= i % COLOR_CHOICES %>"><%= ma._id %></th>
                <%
                }
                }) %>
            </tr>
            </thead>
            <% member_roles.forEach(function(r){%>
            <tr>
                <td style="white-space: nowrap"><b><%= r._id %></b></td>
                <% member_actions.forEach(function(ma,i){ %>
              <% if (_.contains(r.actions, ma._id)){ %>
                <td class="column<%= i % COLOR_CHOICES %>" title="<%= ma._id %>">
                <i class="icon-ok" style="opacity: 0.45"></i></td>
                <% } else { %> <td></td>
                <% } %>
                <% }) %>
                <td></td>
                <td></td>
            </tr>

            <% }) %>

            <thead>
            <tr>
                <th>&nbsp;</th>
                <th>&nbsp;</th>
                <th>&nbsp;</th>

                <% member_actions.forEach(function(ma,i){
                if ((i % 3) == 2) {
                %>
                <th colspan="3" class="column<%= i % COLOR_CHOICES %>"><%= ma._id %></th>
                <%
                }
                }) %>
            </tr>
            <tr class="unbordered">
                <th>&nbsp;</th>
                <th>&nbsp;</th>

                <% member_actions.forEach(function(ma,i){
                if ((i % 3) == 1) {
                %>
                <th colspan="3" class="column<%= i % COLOR_CHOICES %>"><%= ma._id %></th>
                <%
                }
                }) %>
                <th>&nbsp;</th>
            </tr>
            <tr   class="unbordered">
                <th>Role</th>

                <% member_actions.forEach(function(ma,i){
                if ((i % 3) == 0) {
                %>
                <th colspan="3" class="column<%= i % COLOR_CHOICES %>"><%= ma._id %></th>
                <%
                }
                }) %>
                <th>&nbsp;</th>
                <th>&nbsp;</th>
            </tr>
            </thead>
        </table>
    </div>
    <div class="span3">
        <h2>Actions</h2>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>Action</th>
            </tr>
            </thead>
            <% member_actions.forEach(function(ma){%>
            <tr>
                <td><%= ma._id %></td>
            </tr>

            <% }) %>
        </table>
    </div>

</div>